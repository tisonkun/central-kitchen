---
title: '夜天之书 #29 Two Hats of Developers'
---

今天要讲的话题是我在不同场合下提及过这个概念多次的话题。Two Hats of Developers 即**开源软件社区的 contributor 在参与过程中拥有多重身份，既是开源社区当中的志愿者，又是商业公司的员工或自由职业者等等。**这个观点对如何运行一个开源社区的方方面面都有深远的影响。

可以说，这个概念在我的脑海中很丰富的含义，以至于太过丰富在之前的大半年里一直无法用简单的文字描述出来。近几天反思 KPI 导向的衡量指标带来的种种问题的时候突然找到了灵感，以下正文。

## 开源项目和商业公司

在讨论如何衡量开源软件社区的指标之前，我们需要了解开源软件项目和商业公司之间的关系。因为大部分 KPI 导向的衡量指标，实际上指的是商业公司里的员工被摊派的指标。

这个话题同样在 FLOSSWAY 计划下的 [The relationship between community and company](https://github.com/flossway/flossway/discussions/2) 议题里讨论。

今天，不少新兴的科技公司声称自己是“开源技术公司”，并创造了“主导公司”“背后的商业公司”和“社区用户”等等词汇。我要讲的开源项目和商业公司的关系，就是和这类公司之间的关系。

开源社区通用的行为准则之一是“赢得权威”，即 contributor 通过 contribution 创造价值赢得其他社区成员的信任和尊重，积累社会资本，而不是通过在商业公司当中的地位获得权力。开源社区的公平性是基于 contribution 赢得权威的精英领导制。因此强调社区当中有一家“主导公司”进而暗示这家公司及其雇员的主导地位是不切实际的。

个人 contributor 可以通过自己的 contribution 积累社会资本，公司也可以通过公司层面的 contribution 来赢得声望，包括主办社区活动，支持员工参与社区，赞助社区日常支出等等。社区成员都会知道哪家公司为社区的发展做出了重大贡献。公司的这种 soft influence 在[夜天之书 #5](yatennosyo-0005.md)当中也有介绍。

然而，近年来不少打着“开源技术公司”名号的组织，却在 open-source 的旗帜下行 source available 专有软件之实。在上一篇文章[夜天之书 #28 What is Open Source](what-is-open-source.md) 当中提到

> Contribute 这些项目，并不能保证自己的努力始终以开源的形式存在，乃至于自己都不能享受到 contribute 带来的改善。这种源码可得的专有软件的开发模式，实际上仍未摆脱一个组织一家公司雇一拨人写一个软件本身就是产品拿来盈利的思路。随着 contributor 逐渐发现这类软件协议上的不平等以及时不时出现的改换协议的案例，最终源码可得的专有软件会像传统专有软件一样无法获得开源协同带来的生产力提升。

在讨论开源项目和商业公司应该有的关系之前，我们先来看由于项目和公司定位杂糅带来的问题。

**核心问题在于开源项目的天性与商业公司的需求的割裂。**

这看起来有些不可思议，明明是把项目和公司定位杂糅了，为什么问题却是两者之间的割裂呢？其实这也不奇怪，因为开源项目和商业公司天生有着不同的关注点，强行糅合在一起，会出现的自然是相互排斥带来的割裂。

这种割裂的典型特征就是商业公司为了保证绝对的控制，在开源项目公开的开发流水线以外，搭建了属于“主导公司”的第二流水线，并在随后的时间里逐渐控制不住第二流水线对公开流水线的侵袭。

我们来看两个例子。

**第一个是经典问题“应该在社区上投入多少时间”。**这可以说是当下“大厂开源”背上指标的员工被问得最痛苦的问题了。导致这个问题的根源，就是存在第二流水线。

不管是否实践开源项目当中公平参与的原则，哪怕是 GitHub 等形式的托管，都足以挑动商业公司遵循传统控制理论指导下的神经。换句话说，只要做到“开放源代码”这个基本动作，许多商业公司就快受不了了。为什么不是公司内可见？读写权限管控呢？依赖库有没有经过安全专家审计？如果 A/B/C/D/E 情况发生，如何保证公司的利益？

这样的担忧下，基于 GitHub Issue + Pull Request 或其他形式的天然的公开流水线就会被排斥。要么彻底弃用，就做镜像，那么 contributor 毫无门路进来，倒也是彻头彻尾的 source available 专有软件。但是商业公司又想蹭个开源的热度，就会保留一些入口。同时出于上面提到控制论作祟，这个公开流水线是受到歧视的，会在公司之内搭建起第二流水线。

![community-company-silos](media/community-company-silos.png)

如上图所示，community 部分有一套流水线，company 部分也有一套流水线。软件代码很相似，但又略微有所不同，稍有经验的程序员都知道这种情况下不同版本出现的问题定位调试起来是最折磨的。另外持续集成等流水线要么是重复的，要么是有不同关注点的。community 部分关注的是社区成员之间的合作和项目的质量，company 部分关注的是产品的应用和线上问题。

这两套流水线很容易产生冗余和不同关注点相互侵入。要么是保障软件质量的测试套件和测试样例一直纠结到底应该放在哪，重复实现的持续集成逻辑。要么是 OnCall 乃至公司绩效指标相关的统计信息侵入到 community 部分的标注当中，在 community 里出现了社区成员并不关心的公司特有信息。

推崇敏捷开发的同学也许注意到我用 silo 来描述这种模式，其实这就是典型的 community 一个职能竖井，company 一个职能竖井，这种情况下指望两个实体之间互相提供价值是不切实际的。而这，却是当下大部分商业公司的做法。

成立一个“社区部门”，一锅乱炖把用户社区、应用开发者社区和内核开发者社区全都丢给这个孤立无援的团队。实际上，一个开源项目真正要在这几点上都取得成功，所面临的的挑战不亚于让一家创业公司存活或成功，而传统的管理者仍然认为这是工程师或者加上运营人员就能搞定的问题。

应对这个问题的方法并不复杂。Community 实际上是一个横向基石的概念，而非纵向的职能竖井。商业公司的产品建立在开源项目的软件上，而非软件本身就是产品。同时，商业公司的员工开发产品时依赖的是开源软件，对其修改贡献回上游也即参与开源项目，因此同时也是开源项目社区的贡献者。

![commercial-software-on-open-source-software](media/commercial-software-on-open-source-software.png)

如上图所示，在这个结构下，commercial 部分只做商业必须的流水线，同时该作为专有软件开发的插件或服务作为专有软件开发。“应该在社区上投入多少时间”的问题也不攻自破，因为根本不需要额外在“社区上投入时间”，你的产品就是基于开源项目做的，遇到问题该投入时间就投入时间。同时，community 也成为整个产品相关的员工会关注的实体，而不是单靠一个“社区部门”大声疾呼。

**第二个例子是流程管控。**这一点在上面的例子里也有所提及，我们以一个具体的例子展开。

## 2C 运营模式的误区

## 2C 运营模式的运用

## 传统 KPI 指标的问题

## 开源社区的引力模型

**开源社区当中，行为就是结果。**
