---
title: '夜天之书 #29 Two Hats of Developers'
---

今天要讲的话题是我在不同场合下提及过这个概念多次的话题。Two Hats of Developers 即**开源软件社区的 contributor 在参与过程中拥有多重身份，既是开源社区当中的志愿者，又是商业公司的员工或自由职业者等等**。这个观点对如何运行一个开源社区的方方面面都有深远的影响。

可以说，这个概念在我的脑海中很丰富的含义，以至于太过丰富在之前的大半年里一直无法用简单的文字描述出来。近几天反思 KPI 导向的衡量指标带来的种种问题的时候突然找到了灵感，以下正文。

## 开源项目和商业公司

在讨论如何衡量开源软件社区的指标之前，我们需要了解开源软件项目和商业公司之间的关系。因为大部分 KPI 导向的衡量指标，实际上指的是商业公司里的员工被摊派的指标。

这个话题同样在 FLOSSWAY 计划下的 [The relationship between community and company](https://github.com/flossway/flossway/discussions/2) 议题里讨论。

今天，不少新兴的科技公司声称自己是“开源技术公司”，并创造了“主导公司”“背后的商业公司”和“社区用户”等等词汇。我要讲的开源项目和商业公司的关系，就是和这类公司之间的关系。

开源社区通用的行为准则之一是“赢得权威”，即 contributor 通过 contribution 创造价值赢得其他社区成员的信任和尊重，积累社会资本，而不是通过在商业公司当中的地位获得权力。开源社区的公平性是基于 contribution 赢得权威的精英领导制。因此强调社区当中有一家“主导公司”进而暗示这家公司及其雇员的主导地位是不切实际的。

个人 contributor 可以通过自己的 contribution 积累社会资本，公司也可以通过公司层面的 contribution 来赢得声望，包括主办社区活动，支持员工参与社区，赞助社区日常支出等等。社区成员都会知道哪家公司为社区的发展做出了重大贡献。公司的这种 soft influence 在[夜天之书 #5](yatennosyo-0005.md)当中也有介绍。

然而，近年来不少打着“开源技术公司”名号的组织，却在 open-source 的旗帜下行 source available 专有软件之实。在上一篇文章[夜天之书 #28 What is Open Source](what-is-open-source.md) 当中提到

> Contribute 这些项目，并不能保证自己的努力始终以开源的形式存在，乃至于自己都不能享受到 contribute 带来的改善。这种源码可得的专有软件的开发模式，实际上仍未摆脱一个组织一家公司雇一拨人写一个软件本身就是产品拿来盈利的思路。随着 contributor 逐渐发现这类软件协议上的不平等以及时不时出现的改换协议的案例，最终源码可得的专有软件会像传统专有软件一样无法获得开源协同带来的生产力提升。

在讨论开源项目和商业公司应该有的关系之前，我们先来看由于项目和公司定位杂糅带来的问题。

**核心问题在于开源项目的天性与商业公司的需求的割裂。**

这看起来有些不可思议，明明是把项目和公司定位杂糅了，为什么问题却是两者之间的割裂呢？其实这也不奇怪，因为开源项目和商业公司天生有着不同的关注点，强行糅合在一起，会出现的自然是相互排斥带来的割裂。

这种割裂的典型特征就是商业公司为了保证绝对的控制，在开源项目公开的开发流水线以外，搭建了属于“主导公司”的第二流水线，并在随后的时间里逐渐控制不住第二流水线对公开流水线的侵袭。

我们来看两个例子。

**第一个是经典问题“应该在社区上投入多少时间”**。这可以说是当下“大厂开源”背上指标的员工被问得最痛苦的问题了。导致这个问题的根源，就是存在第二流水线。

不管是否实践开源项目当中公平参与的原则，哪怕是 GitHub 等形式的托管，都足以挑动商业公司遵循传统控制理论指导下的神经。换句话说，只要做到“开放源代码”这个基本动作，许多商业公司就快受不了了。为什么不是公司内可见？读写权限管控呢？依赖库有没有经过安全专家审计？如果 A/B/C/D/E 情况发生，如何保证公司的利益？

这样的担忧下，基于 GitHub Issue + Pull Request 或其他形式的天然的公开流水线就会被排斥。要么彻底弃用，就做镜像，那么 contributor 毫无门路进来，倒也是彻头彻尾的 source available 专有软件。但是商业公司又想蹭个开源的热度，就会保留一些入口。同时出于上面提到控制论作祟，这个公开流水线是受到歧视的，会在公司之内搭建起第二流水线。

![community-company-silos](media/community-company-silos.png)

如上图所示，community 部分有一套流水线，company 部分也有一套流水线。软件代码很相似，但又略微有所不同，稍有经验的程序员都知道这种情况下不同版本出现的问题定位调试起来是最折磨的。另外持续集成等流水线要么是重复的，要么是有不同关注点的。community 部分关注的是社区成员之间的合作和项目的质量，company 部分关注的是产品的应用和线上问题。

这两套流水线很容易产生冗余和不同关注点相互侵入。要么是保障软件质量的测试套件和测试样例一直纠结到底应该放在哪，重复实现的持续集成逻辑。要么是 OnCall 乃至公司绩效指标相关的统计信息侵入到 community 部分的标注当中，在 community 里出现了社区成员并不关心的公司特有信息。

推崇敏捷开发的同学也许注意到我用 silo 来描述这种模式，其实这就是典型的 community 一个职能竖井，company 一个职能竖井，这种情况下指望两个实体之间互相提供价值是不切实际的。而这，却是当下大部分商业公司的做法。

成立一个“社区部门”，一锅乱炖把用户社区、应用开发者社区和内核开发者社区全都丢给这个孤立无援的团队。实际上，一个开源项目真正要在这几点上都取得成功，所面临的的挑战不亚于让一家创业公司存活或成功，而传统的管理者仍然认为这是工程师或者加上运营人员就能搞定的问题。

应对这个问题的方法并不复杂。Community 应该是一个横向基石的概念，而非纵向的职能竖井。商业公司的产品建立在开源项目的软件上，而非软件本身就是产品。同时，商业公司的员工开发产品时依赖的是开源软件，对其修改贡献回上游也即参与开源项目，因此同时也是开源项目社区的贡献者。

![commercial-software-on-open-source-software](media/commercial-software-on-open-source-software.png)

如上图所示，在这个结构下，commercial 部分只做商业必须的流水线，同时该作为专有软件开发的插件或服务作为专有软件开发。“应该在社区上投入多少时间”的问题也不攻自破，因为根本不需要额外在“社区上投入时间”，你的产品就是基于开源项目做的，遇到问题该投入时间就投入时间。同时，community 也成为整个产品相关的员工会关注的实体，而不是单靠一个“社区部门”大声疾呼。

**第二个例子是流程管控**。这一点在上面的例子里也有所提及，我们以一个具体的例子展开。

社区当中也需要流程来帮助 contributor 创造价值。如何加入这个社区，如何提交贡献，如何合作和处理冲突，这些信息对于 contributor 来说都是有益的。然而，社区当中的流程只有简单才能持久，流程应当是从社区成员的共识中归纳出来的，绝不会是流程管控。

“主导公司”很容易在公司之内成立一个经典的产品经理、项目经理和开发者的开发结构。要求任何需求的开发都经过经理乃至公司之内的某种委员会评审之后才能实施。一旦加上这种规矩，公司又把持着社区的控制权，一个自然而然的可怕的念头就诞生了，“‘外部贡献者’也应该遵守相同的流程”。否则，经理和委员会乃至商业公司就会感受到强烈的冲击，认定“外部贡献者”是失控的，是有毒的。

这是完全错误的想法。

社区当中的 contributor 是公平的参与，遵守 **earn authority by contribution, not by position** 的原则。反观这些经理和委员会成员，在商业公司中往往从未参与过 community 的任何活动，甚至都没露过面，仅仅按照传统的控制理论还就是以 position 强行占有权力发号施令。

这在控制型组织结构中也许是生效的，过去的几十年间也都是这样运作的。但是开源软件社区是跨越组织边界的协同支撑起来的，contributor 不会买你公司的账。我凭着自己的技术实力做出 contribution 努力改善软件，为什么要向你这家商业公司里一个没有 contribution 的管理人员汇报？我给你打白工？这种冲突愈发加剧了管理人员的危机感，再次认定“外部贡献者”是失控的，是有毒的。

另一方面，我曾在一个分享上提过，contributor 能够开始 contribute 开源软件，乃至持之以恒地创造价值，其核心动力来自于对项目愿景和技术能力的认可，是完全自驱全力以赴的。这跟打工人的思路是不一样的。因此，contributor 有更强的动力去遵守简单有效的流程，哪怕商业公司的打工人觉得这跟我的本职工作无关，好麻烦啊不如直接提交代码算了别的都毁灭吧。因此，contributor 有更强的动力去推动 contribution 落地，虽然不愿意向一个莫名的管理人员汇报，不愿意被奇怪的时间排期限制（当然，项目层面的 code freeze 是可以理解的），哪怕商业公司的打工人认为能不做就不做，混一天是一天。

这并不是说商业公司的员工都是打工人，我只是在对比两种不同的心态。实际上，根据[《企业的人性面》](https://book.douban.com/subject/27125968/)等著作中的论述，打工人心态并不是本性，而是出于管理者的假设。

> 采用 X 理论的观点，就免不了会重视各项控制的技巧，包括以下步骤和方法：告诉人们该做什么、确定人们是否在做，以及给予奖励和惩罚，等等。由于 X 理论的假设是人只有被指使才会为组织的成功效力，因此我们会很自然地关注指挥和控制的技巧。
> 
> 与此相比，Y 理论更关注“关系的特征”，期待由此建立一种环境，鼓励我们对组织目标作出承诺；同时也提供机会，使我们发挥最大的主动性、天赋以及自我指导力等，以达到组织的目标。
>
> 最重要的是，Y理论的假设说明了一个事实：组织中，人们互相合作的限制并非来自人类本性，而是源于管理方法不当，不知道该如何充分利用人力资源的潜力。X理论为管理者提供了很好的理由，可以解释组织绩效低下的原因，即人类本性所致。而Y理论则将问题归于管理本身：如果员工表现懒散、态度冷漠、进避责任、拒绝合作、缺乏创新，那一定是因为管理者没有采取适当的组织与控制方法。

在强个体的价值崛起的今天，如果不了解新的组织认知方式，在开源项目和商业公司中都激发人的自我指导和自我激励，那么组织管理一定是失败的。只不过在商业公司当中迫于劳资关系员工或许只会沉默地对抗，而开源项目当中 contributor 会直接质疑或用脚投票。

从敏捷宣言的角度来说，**个体和互动高于流程和工具**这个原则也是反对流程管控的理论依据。可以说，成功的开源软件开发天生就只有敏捷一条路。

两个例子讲完，我们抛出开源项目和商业公司应有的关系的结论。其实在上面的讨论中已经蕴含了这个结论，那就是**开源项目和商业公司是两个独立的实体，商业公司基于开源项目构建起自己的商业产品或服务，并持续投入回馈开源社区。**

抛开上面字里行间讲过的原因，我们来聊聊要做到这一点的方法。我们需要刻意地分开开源项目和商业公司，这因为大环境下控制论力量太过强大，一旦定位有所重合，第二流水线侵入公开流水线，乃至社区成员对两者之间的差异的模糊化认知都不可避免。比如，提起 MongoDB 和 ElasticSearch 这两个项目，你是不是只能想到同名的产品和几近同名的公司？

要想区分开开源项目和商业公司的定位，以及实际上分开两个实体。

**第一点就是起一个不同的名字**，千万不要图简单对着 Xxx 项目起一个 XxxLabs 的公司名。这其实已经暴露了你的思维惯性命中了上面大部分的坏例子，并且公司员工一定分不清开源项目和商业公司。客观上存在的不会参与开源项目的公司员工，对外宣称自己是 XxxLabs 的人，也会引起社区成员的混乱。XxxLabs 的财务人员跟我这个 contributor 为什么会共享同一个名字？归属感在这种情况下非常难以建立。

**第二点就是避免商业公司攫取过度的权力**，包括上面讲到的第二流水线入侵，流程管控限制，以及潜在的修改协议的威胁。如果将开源项目从一开始就视作，或者最初的作者就当做独立项目运行，license 选择正确，阻止暗藏杀机的 CLA 落地，在多样化的社区力量发展之后，商业公司也就无法攫取过度的权力了。

**第三点，也就是为了保证比较模糊的第二点能落实的一个要点，是商业公司想要开发一个开源项目，从一开始就要建立起上游开源项目和下游商业公司 fork 的认知体系**。即使一开始的时候都是在开发项目，没有商业产品的影响，员工作为 contributor 可以直接在上游开源项目开发，但是这种存在一个下游商业公司 fork 的模式，将很大程度保护商业压力和客户需求侵入到上游开源社区。

比如 Apache Pulsar 项目，StreamNative 公司就制作了一个公司层面的 fork 并以 mirror issue 等形式建立起商业公司关注的内容的一个在开源项目信息之上的视图。

商业公司必须为客户提供价值，因此产品或服务的 hotfix 和 hacking 不可避免。但是如果像某些公司一样产品即软件，那么这种需求就会变成必须往开源项目倾倒服务于“主导公司”的客户，但是从开源项目本身看无意义，或者可以做得更好的变更。如果是一个公平的 earn authority by contribution 的社区，这种提案很容易通不过，或者延期。于是商业公司又判断“外部贡献者”是失控的，是有毒的，必须建立起一套控制机制来贯彻自己的商业利益。

而如果有一个下游商业公司 fork 来缓冲这些需求，紧急处理之后再思考如何 contributing back 等等，就变成一个早就经过研究的 upstream first 原则的理解和落实的问题。不需要创造出一个新的问题来思考解决方式，甚至根本就是无解。

区分开了开源项目和商业公司，杂糅项目和产品以及公司的 KPI 指标也就没了意义。我们从 2C 运营模式和开发者社区的传统 KPI 指标两个方面讨论如何衡量开源软件社区的指标。

## 2C 运营模式的误区

## 2C 运营模式的运用

## 传统 KPI 指标的问题

## 开源社区的引力模型

**开源社区当中，行为就是结果。**
